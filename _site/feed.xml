<?xml version="1.0" encoding="UTF-8"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>alistair mcmillan</title>
    <description>Mostly a place for me to note things down so I don&#39;t forget them.</description>
    <link>https://alistairmcmillan.github.io/</link>
    <atom:link href="https://alistairmcmillan.github.io/feed.xml" rel="self" type="application/rss+xml"/>
    <pubDate>Thu, 24 Sep 2015 00:24:18 +0100</pubDate>
    <lastBuildDate>Thu, 24 Sep 2015 00:24:18 +0100</lastBuildDate>
    <generator>Jekyll v2.5.3</generator>
    
      <item>
        <title>VirtualStore?</title>
        <description>&lt;p&gt;The other day I wanted to change the list of servers within my SAP GUI.&lt;/p&gt;

&lt;p&gt;&lt;a class=&quot;image&quot; href=&quot;/images/SAP Logon Pad.png&quot; data-lightbox=&quot;image-1&quot; data-title=&quot;SAP GUI aka Logon Pad&quot;&gt;
&lt;img src=&quot;/images/SAP Logon Pad.png&quot; style=&quot;width:400px;&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;The GUI gets the list from a plain text file called saplogon.ini. That file can be stored anywhere though. If you check PCs with SAP installed it’s not unusual to find more than one saplogon.ini file in various places. The quickest way to find the one that is being used is to check  Options within the SAP GUI (click on the icon in the top-left corner of the GUI window and choose “Options…” from the menu). If you select Local Configuration Files it should tell you the location of the saplogon.ini file that is actually in use.&lt;/p&gt;

&lt;p&gt;&lt;a class=&quot;image&quot; href=&quot;/images/SAP GUI Options.png&quot; data-lightbox=&quot;image-1&quot; data-title=&quot;SAP GUI Options&quot;&gt;
&lt;img src=&quot;/images/SAP GUI Options.png&quot; style=&quot;width:400px;&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;So it’s using c:\Windows\SAPLOGON.INI. I closed the GUI, swapped that file and reopened the GUI. But it didn’t recognise that anything had changed. I tried a few different things but it failed to recognise anything changing. So where was it reading that information from? Even though the software claimed to be reading from c:\Windows\SAPLOGON.INI that didn’t seem to be the case.&lt;/p&gt;

&lt;p&gt;A handy tool to see where applications are reading and writing to is &lt;a href=&quot;https://technet.microsoft.com/en-us/sysinternals/bb896645&quot;&gt;Process Monitor&lt;/a&gt; from Sysinternals (now part of Microsoft). By default it shows you pretty much all activity on your machine but you can filter it to look for something specific. In this case I opened the Filter dialog (CTRL-L), created a rule to look for “Path” “contains” “SAPLOGON.INI”, clicked the Add button and then OK.&lt;/p&gt;

&lt;p&gt;&lt;a class=&quot;image&quot; href=&quot;/images/Process Monitor filter for SAPLOGON.INI.png&quot; data-lightbox=&quot;image-1&quot; data-title=&quot;Process Monitor filter for paths containing SAPLOGON.INI&quot;&gt;
&lt;img src=&quot;/images/Process Monitor filter for SAPLOGON.INI.png&quot; style=&quot;width:400px;&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Now with the filter running, I reopened the SAP GUI and as you can see the application was actually reading a completely different saplogon.ini stored in c:\Users\alistair\AppData\Local\VirtualStore\Windows.&lt;/p&gt;

&lt;p&gt;&lt;a class=&quot;image&quot; href=&quot;/images/Process Monitor filtered on SAPLOGON.INI.png&quot; data-lightbox=&quot;image-1&quot; data-title=&quot;Process Monitor filtered on SAPLOGON.INI&quot;&gt;
&lt;img src=&quot;/images/Process Monitor filtered on SAPLOGON.INI.png&quot; style=&quot;width:400px;&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;h2 id=&quot;so-what-is-the-virtualstore-folder&quot;&gt;So what is the VirtualStore folder?&lt;/h2&gt;

&lt;p&gt;From an article on Microsoft’s TechNet Magazine called &lt;a href=&quot;https://technet.microsoft.com/en-us/magazine/2007.06.uac.aspx&quot;&gt;Inside Windows Vista User Account Control&lt;/a&gt; (the feature was introduced with Vista but it’s there in later versions of Windows too):&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;While some software legitimately requires administrative rights, many programs needlessly store user data in system-global locations.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;blockquote&gt;
  &lt;p&gt;Windows Vista enables these legacy applications to run in standard user accounts through the help of file system and registry namespace virtualization. When an application modifies a system-global location in the file system or registry and that operation fails because access is denied, Windows redirects the operation to a per-user area; when the application reads from a system-global location, Windows first checks for data in the per-user area and, if none is present, permits the read attempt from the global location.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;blockquote&gt;
  &lt;p&gt;For the purposes of this virtualization, Windows Vista treats a process as legacy if it’s 32-bit (versus 64-bit), is not running with administrative rights, and does not have a manifest file indicating that it was written for Windows Vista.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;So Windows is recognising that the version of the SAP GUI that I’m running (version 730) was designed for a previous version of Windows where security wasn’t taken so seriously. Although the application thinks it is talking to the ini file in the c:\Windows folder, Windows is actually redirecting those requests to a copy of the file within my own profile where I don’t need administrator rights. Quietly behind the scenes. Leaving this legacy application unaware that anything is happening.&lt;/p&gt;

&lt;p&gt;So I swapped the file in that VirtualStore folder and the SAP GUI picked up the changes. Alternatively I could have deleted the copy in my VirtualStore and Windows would have allowed the application to talk to the original I’d already changed in the c:\Windows folder.&lt;/p&gt;
</description>
        <pubDate>Wed, 23 Sep 2015 21:52:38 +0100</pubDate>
        <link>https://alistairmcmillan.github.io/windows/virtualstore/processmonitor/sap/sapgui/saplogon.ini/2015/09/23/virtualstore.html</link>
        <guid isPermaLink="true">https://alistairmcmillan.github.io/windows/virtualstore/processmonitor/sap/sapgui/saplogon.ini/2015/09/23/virtualstore.html</guid>
        
        
        <category>windows</category>
        
        <category>virtualstore</category>
        
        <category>processmonitor</category>
        
        <category>sap</category>
        
        <category>sapgui</category>
        
        <category>saplogon.ini</category>
        
      </item>
    
      <item>
        <title>Bloated exports from Pages 5.2 and 5.5</title>
        <description>&lt;p&gt;Recently I noticed something strange in the current Mac version of Apple’s &lt;a href=&quot;http://www.apple.com/mac/pages/&quot;&gt;Pages&lt;/a&gt; (version 5.2 1860). If you create a new blank document and immediately save the file in Pages own format you get a 62 KB file, but if you export it in “.docx” format you get a 493 KB file, almost 8 times bigger. And if you export it in “.doc (Word 1997-2004 compatible)” format, you get a huge 1.5 MB file that’s &lt;strong&gt;&lt;em&gt;24&lt;/em&gt;&lt;/strong&gt; times bigger.&lt;/p&gt;

&lt;p&gt;So what is it putting in these files?
&lt;!--more--&gt;
Given that .docx formatted documents are basically zip files with a different extension it’s quite easy to see what is inside them. Simply append .zip to the filename and double-click on the file to have your Mac open the file with the default zip file handler Archive Utility. And you’ll find these files in the extracted folder…&lt;/p&gt;

&lt;p&gt;&lt;a class=&quot;image&quot; href=&quot;/images/ExtractedUntitledDocx.png&quot; data-lightbox=&quot;image-1&quot; data-title=&quot;Folder of extracted blank Word docx document files&quot;&gt;
&lt;img src=&quot;/images/ExtractedUntitledDocx.png&quot; align=&quot;center&quot; style=&quot;width:200px;&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Most of those files are tiny, but that image1.png file in the media folder is 489 KB alone. &lt;a href=&quot;/images/image1.png&quot;&gt;A big 635x635px textured blue square.&lt;/a&gt; However why is it there? It is mentioned within the theme files as the fill on a default shape, but there are no shapes in an empty blank document so that PNG file serves no purpose. So that explains the 493 KB file size of the exported docx file.&lt;/p&gt;

&lt;p&gt;Unfortunately files in the Word 1997-2004 compatible format use a much less friendly binary format to store their data. There are probably instructions out there to help you parse the format and try to understand what it is doing, but a quick way to check is to load the file into a hex editor like &lt;a href=&quot;http://ridiculousfish.com/hexfiend/&quot;&gt;Hex Fiend&lt;/a&gt; and search for the “âPNG” and “IEND” markers that respectively indicate the start and end of a PNG file.&lt;/p&gt;

&lt;p&gt;&lt;a class=&quot;image&quot; href=&quot;/images/HexFiendUntitleddoc.png&quot; data-lightbox=&quot;image-2&quot; data-title=&quot;The blank Word 97-2004 document in Hex Fiend&quot;&gt;
&lt;img src=&quot;/images/HexFiendUntitleddoc.png&quot; style=&quot;width:200px;&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Sure enough the file has that same embedded PNG with its blue texture, but it also has a similar file with a green tint and another similar file with a yellow tint. All of them 489 KB in size and if you subtract the three 489 KB files from that huge 1.5 MB you are left with 69 KB of data. So that explains the extra padding on the Word 1997-2004 formatted document.&lt;/p&gt;

&lt;p&gt;Reported to Apple as &lt;a href=&quot;rdar://17089255&quot;&gt;rdar://17089255&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;Meanwhile, if you use Pages to edit documents and need to send someone a file in “.doc (Word 1997-2004 compatible)” format a solution to remove the unnecessary bloat is to open the affected files and then immediately save them again using the same format in &lt;a href=&quot;http://www.microsoft.com/mac&quot;&gt;Microsoft Word for Mac&lt;/a&gt;, &lt;a href=&quot;https://www.libreoffice.org&quot;&gt;LibreOffice&lt;/a&gt; or the old Pages ‘09 (tested in version 14.4.2, 4.2.4 and 4.3 1048 respectively). All of them strip out the unnecessary PNG files reducing the file size to something sensible.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Update October 26, 2014&lt;/strong&gt;: Tested in the recently released v5.5 (2109) and Pages is still doing exactly the same thing. My bug report is still sitting untouched almost five months later.&lt;/p&gt;
</description>
        <pubDate>Sat, 31 May 2014 22:31:38 +0100</pubDate>
        <link>https://alistairmcmillan.github.io/mac/pages/bug/2014/05/31/bloated-exports-from-pages-5.2.html</link>
        <guid isPermaLink="true">https://alistairmcmillan.github.io/mac/pages/bug/2014/05/31/bloated-exports-from-pages-5.2.html</guid>
        
        
        <category>mac</category>
        
        <category>pages</category>
        
        <category>bug</category>
        
      </item>
    
      <item>
        <title>How to add a DatePicker to a Windows Phone 8 app</title>
        <description>&lt;p&gt;I’ve been playing about with Microsoft’s Windows Phone developer tools. I wanted to add a Date Picker control. Based on using Xcode I thought this would be easy. It wasn’t.
&lt;!--more--&gt;
For comparison, here is how you add a Date Picker control to your iPhone or iPad app…&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Start typing “Date” into the search box at the bottom of the Object library in the bottom-right corner of the Xcode window, and the “Date Picker” object quickly appears.&lt;/li&gt;
  &lt;li&gt;Drag the object into place.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;a href=&quot;/images/Xcode_DatePicker.png&quot; data-lightbox=&quot;image-1&quot; data-title=&quot;Date Picker object in Xcode&quot;&gt;
&lt;img src=&quot;/images/Xcode_DatePicker.png&quot; style=&quot;width:200px;&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;And here is how you do it in a Windows Phone 8 app.&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;Open the Package Manager Console from the Tools menu. Tools -&amp;gt; NuGet Package Manager -&amp;gt; Package Manager Console.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Within the Package Manager Console type “Install-Package WPtoolkit” to instruct Visual Studio to install the Windows Phone Toolkit.&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;a href=&quot;/images/VS_Install-Package_WPtoolkit.png&quot; data-lightbox=&quot;image-1&quot; data-title=&quot;Installing the WPtoolkit in Visual Studio&quot;&gt;
&lt;img src=&quot;/images/VS_Install-Package_WPtoolkit.png&quot; style=&quot;width:200px;&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Near the top of the XAML file where you want to use a DatePicker add the following line of code: &lt;code&gt;xmlns:toolkit=&quot;clr-namespace:Microsoft.Phone.Controls;assembly=Microsoft.Phone.Controls.Toolkit&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;a href=&quot;/images/VS_toolkit_namespace.png&quot; data-lightbox=&quot;image-1&quot; data-title=&quot;Adding the Microsoft.Phone.Controls namespace in Visual Studio&quot;&gt;
&lt;img src=&quot;/images/VS_toolkit_namespace.png&quot; style=&quot;width:200px;&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Then where you want to include a DatePicker control add the following line of code: &lt;code&gt;&amp;lt;toolkit:DatePicker /&amp;gt;&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;a href=&quot;/images/VS_DatePicker.png&quot; data-lightbox=&quot;image-1&quot; data-title=&quot;Adding a DatePicker control in Visual Studio&quot;&gt;
&lt;img src=&quot;/images/VS_DatePicker.png&quot; style=&quot;width:200px;&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;There may be an easier way, but this took over an hour of searching Google and reading through forum posts until I found a way that actually worked.&lt;/p&gt;
</description>
        <pubDate>Sun, 18 May 2014 15:37:55 +0100</pubDate>
        <link>https://alistairmcmillan.github.io/windows%20phone%208/mobile%20development/2014/05/18/how-to-add-a-date-picker.html</link>
        <guid isPermaLink="true">https://alistairmcmillan.github.io/windows%20phone%208/mobile%20development/2014/05/18/how-to-add-a-date-picker.html</guid>
        
        
        <category>windows phone 8</category>
        
        <category>mobile development</category>
        
      </item>
    
      <item>
        <title>The Static Countdown</title>
        <description>&lt;p&gt;At the top of the &lt;a href=&quot;http://www.glasgow2014.com&quot;&gt;Glasgow 2014 Commonwealth Game&lt;/a&gt; website they tell you the amount of time left until the launch of the games. As of writing it says “224 DAYS 20 HOURS, 19 MINUTES &amp;amp; 03 SECONDS TO GO.” Strangely though it doesn’t count down.&lt;/p&gt;

&lt;p&gt;It’s the kind of thing you’d expect to count down.&lt;/p&gt;

&lt;p&gt;The first time I visited the website I was using Google Chrome, so I decided to try another browser. It doesn’t count down if you use Mozilla Firefox either. However if you try an old version of Internet Explorer, version 6, the website does count down. So there is a bug somewhere.
&lt;!--more--&gt;
The way you’d expect a countdown to work is a DIV element on an HTML page, with a piece of JavaScript set to run every second to calculate the time and update the contents of the DIV. Glancing through the code of the website and sure enough there is a DIV tagged “countdown-timer” and in an external JavaScript file called “script.js” there is a little plugin called &lt;a href=&quot;http://keith-wood.name/countdown.html&quot;&gt;Countdown for jQuery&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;The code in the script.js has been minified (all the extra space has been removed to reduce the amount of data sent and received over the Internet) which makes it difficult to read, but it can be passed through a beautifier to expand it again and format it in an easier to read layout. So after grabbing a copy of the code from the front page and a copy of the JavaScript file which I passed through http://jsbeautifier.org/ to make it easier to read I had a copy of the front page to play with.&lt;/p&gt;

&lt;p&gt;Within the Countdown plugin is a function called &lt;code&gt;Countdown()&lt;/code&gt; that sets up initial values for the countdown and also sets up a loop to update the time. Funnily enough it actually has code for two loops. One for older browsers (which explains why Internet Explorer 6 works), and another loop that supports modern browsers. But unfortunately as demonstrated by the static countdown in modern browsers there is a bug in that second loop.&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-javascript&quot; data-lang=&quot;javascript&quot;&gt;&lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;timerCallBack&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;timestamp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
	&lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;drawStart&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;timestamp&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;||&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;Date&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;().&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;getTime&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;());&lt;/span&gt;
	&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;drawStart&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;animationStartTime&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
		&lt;span class=&quot;nx&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;countdown&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;_updateTargets&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
		&lt;span class=&quot;nx&quot;&gt;animationStartTime&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;drawStart&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
	&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
	&lt;span class=&quot;nx&quot;&gt;requestAnimationFrame&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;timerCallBack&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;requestAnimationFrame&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;window&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;requestAnimationFrame&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;||&lt;/span&gt; 
				&lt;span class=&quot;nb&quot;&gt;window&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;webkitRequestAnimationFrame&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;||&lt;/span&gt;
				&lt;span class=&quot;nb&quot;&gt;window&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;mozRequestAnimationFrame&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;||&lt;/span&gt;
				&lt;span class=&quot;nb&quot;&gt;window&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;oRequestAnimationFrame&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;||&lt;/span&gt;
				&lt;span class=&quot;nb&quot;&gt;window&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;msRequestAnimationFrame&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;||&lt;/span&gt;
				&lt;span class=&quot;kc&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;animationStartTime&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;requestAnimationFrame&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
	&lt;span class=&quot;nx&quot;&gt;setInterval&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
		&lt;span class=&quot;nx&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;countdown&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;_updateTargets&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
	&lt;span class=&quot;p&quot;&gt;},&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;980&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
	&lt;span class=&quot;nx&quot;&gt;animationStartTime&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;window&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;mozAnimationStartTime&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;||&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;Date&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;().&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;getTime&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
	&lt;span class=&quot;nx&quot;&gt;requestAnimationFrame&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;timerCallBack&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;The modern loop uses a new browser feature called &lt;a href=&quot;https://developer.mozilla.org/en/docs/Web/API/window.requestAnimationFrame&quot;&gt;requestAnimationFrame&lt;/a&gt; and on that linked page is the first clue to what is actually going wrong.&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;The callback parameter is a DOMTimeStamp instead of a 
DOMHighResTimeStamp if the prefixed version of this
method was used. DOMTimeStamp only has millisecond
precision, but DOMHightResTimeStamp has a minimal
precision of ten microseconds.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;The problem occurs because the callback function uses the timestamp to decide whether to animate the countdown. It checks whether 1000 milliseconds have elapsed between the timestamp passed into the function and the animationStartTime. Unfortunately though both values store the time, they use different formats. DOMTimeStamp is an integer that stores the number of seconds since the UNIX epoch (1 January 1970 00:00:00 UTC) while DomHighResTimeStamp is a floating point value that reports the number of milliseconds and microseconds from the moment that the browser started navigating to the page.&lt;/p&gt;

&lt;p&gt;A simple fix to this bug is to comment out the un-prefixed version of the method “window.requestAnimationFrame” and reload, then the countdown works perfectly in Chrome, Firefox, mobile browsers, etc, because the timestamp passed into the callback is using the same format as the animationStartTime value stored earlier.&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-javascript&quot; data-lang=&quot;javascript&quot;&gt;&lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;requestAnimationFrame&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;cm&quot;&gt;/* window.requestAnimationFrame || */&lt;/span&gt; 
				&lt;span class=&quot;nb&quot;&gt;window&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;webkitRequestAnimationFrame&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;||&lt;/span&gt;
				&lt;span class=&quot;nb&quot;&gt;window&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;mozRequestAnimationFrame&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;||&lt;/span&gt;
				&lt;span class=&quot;nb&quot;&gt;window&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;oRequestAnimationFrame&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;||&lt;/span&gt;
				&lt;span class=&quot;nb&quot;&gt;window&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;msRequestAnimationFrame&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;||&lt;/span&gt;
				&lt;span class=&quot;kc&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

</description>
        <pubDate>Wed, 11 Dec 2013 07:53:00 +0000</pubDate>
        <link>https://alistairmcmillan.github.io/website/bug/investigation/fix/2013/12/11/the-Static-Countdown.html</link>
        <guid isPermaLink="true">https://alistairmcmillan.github.io/website/bug/investigation/fix/2013/12/11/the-Static-Countdown.html</guid>
        
        
        <category>website</category>
        
        <category>bug</category>
        
        <category>investigation</category>
        
        <category>fix</category>
        
      </item>
    
      <item>
        <title>How to deal with &#39;The specified module could not be found&#39; errors</title>
        <description>&lt;p&gt;When regsvr32 fails with the error &lt;code&gt;LoadLibrary(&quot;softekatl.dll&quot;) failed - The specified module could not be found.&lt;/code&gt; it doesn’t necessarily mean it couldn’t find the specified module. It might mean it couldn’t find another DLL file that the specified module depends on.&lt;/p&gt;

&lt;p&gt;&lt;a class=&quot;image&quot; href=&quot;/images/LoadLibrary-failed.png&quot; data-lightbox=&quot;image-2&quot; data-title=&quot;LoadLibrary failed error&quot;&gt;
&lt;img src=&quot;/images/LoadLibrary-failed.png&quot; style=&quot;width:200px;&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Unfortunately Windows XP doesn’t seem to include tools to help you work out which DLL is actually the cause of the error…&lt;/p&gt;

&lt;h2 id=&quot;how-do-i-work-out-which-dependency-is-causing-loadlibrary-to-fail&quot;&gt;How do I work out which dependency is causing LoadLibrary to fail?&lt;/h2&gt;
&lt;p&gt;Download &lt;a href=&quot;http://www.dependencywalker.com&quot;&gt;Dependency Walker&lt;/a&gt; and run it on the affected PC. Click the Open button and select the DLL that regsvr32 is having problems loading. Dependency Walker will build a tree of all the dependencies and their dependencies and so on. If a particular DLL is missing you should get an &lt;code&gt;Error opening file. The system cannot find the file specified.&lt;/code&gt; error, as shown in the screenshot below.&lt;/p&gt;

&lt;p&gt;&lt;a class=&quot;image&quot; href=&quot;/images/Dependency-Walker.png&quot; data-lightbox=&quot;image-2&quot; data-title=&quot;Dependency Walker&quot;&gt;
&lt;img src=&quot;/images/Dependency-Walker.png&quot; style=&quot;width:200px;&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Find that missing DLL, install it on the machine in a location where Windows will be able to find it and regsvr32 should now be able to register that original DLL you were having a problem with.&lt;/p&gt;

&lt;h2 id=&quot;where-do-i-find-msvcr70dll&quot;&gt;Where do I find MSVCR70.DLL?&lt;/h2&gt;

&lt;p&gt;Version 7.0 of the Microsoft Visual C Runtime was distributed with version 1.0 of the .NET Framework. You can download it from &lt;a href=&quot;http://www.microsoft.com/en-us/download/details.aspx?id=96&quot;&gt;http://www.microsoft.com/en-us/download/details.aspx?id=96&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;Install it on the machine and the machine will now have that MSVCR70.DLL file you want.&lt;/p&gt;

&lt;h2 id=&quot;how-do-i-deal-with-the-install-cannot-continue-because-this-version-of-the-net-framework-is-incompatible-with-a-previously-installed-one-errors&quot;&gt;How do I deal with “The install cannot continue because this version of the .NET Framework is incompatible with a previously installed one.” errors?&lt;/h2&gt;

&lt;p&gt;So… you’ve tried to install version 1.0 of the .NET Framework and it failed with the error &lt;code&gt;The install cannot continue because this version of the .NET Framework is incompatible with a previously installed one. For more information, see http://support.microsoft.com/support/kb/articles/q312/5/00.asp&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;&lt;a class=&quot;image&quot; href=&quot;/images/Microsoft-NET-Framework-Install-cannot-continue-because.png&quot; data-lightbox=&quot;image-2&quot; data-title=&quot;Microsoft NET Framework - Install cannot continue because error&quot;&gt;
&lt;img src=&quot;/images/Microsoft-NET-Framework-Install-cannot-continue-because.png&quot; style=&quot;width:200px;&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;You might think you would visit &lt;a href=&quot;http://support.microsoft.com/support/kb/articles/q312/5/00.asp&quot;&gt;http://support.microsoft.com/support/kb/articles/q312/5/00.asp&lt;/a&gt; but Microsoft changed their website and that URL just redirects to the front page of their Support website. Thank you Microsoft.&lt;/p&gt;

&lt;p&gt;Your mileage might vary… but for me, installing version 1.1 of the .NET Framework (which you can download from &lt;a href=&quot;http://www.microsoft.com/en-us/download/details.aspx?id=26&quot;&gt;http://www.microsoft.com/en-us/download/details.aspx?id=26&lt;/a&gt;) and then version 1.0 worked. Please don’t ask why. And please don’t ask how long it took me to work that out.&lt;/p&gt;

&lt;h2 id=&quot;how-can-i-make-it-so-windows-knows-how-to-find-msvcr70dll&quot;&gt;How can I make it so Windows knows how to find MSVCR70.DLL?&lt;/h2&gt;

&lt;p&gt;So… now you have MSVCR70.dll installed on the machine, but Windows can’t find it, because regsvr32 is still failing with the same error.&lt;/p&gt;

&lt;p&gt;&lt;a class=&quot;image&quot; href=&quot;/images/LoadLibrary-failed.png&quot; data-lightbox=&quot;image-2&quot; data-title=&quot;LoadLibrary failed error&quot;&gt;
&lt;img src=&quot;/images/LoadLibrary-failed.png&quot; style=&quot;width:200px;&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;The .NET Framework 1.0 installer puts the MSVCR70.DLL file in a folder called &lt;code&gt;c:\WINDOWS\Microsoft.NET\Framework\v1.0.3705&lt;/code&gt;. Add that folder location to the PATH variable in Windows and then Windows will be able to find the MSVCR70.dll file.&lt;/p&gt;

&lt;h2 id=&quot;how-do-i-add-folder-locations-to-the-path-variable-in-windows&quot;&gt;How do I add folder locations to the PATH variable in Windows?&lt;/h2&gt;

&lt;p&gt;Open the System applet within Control Panel. Select the Advanced tab and click on the Environment Variables button. Then find and select the Path variable under the System variables section and click on the Edit button. Add &lt;code&gt;;c:\WINDOWS\Microsoft.NET\Framework\v1.0.3705&lt;/code&gt; to the end of the existing path. Don’t forget to include a semi-colon before the new folder location to separate it from the existing locations. Then click OK a few times until the System applet has disappeared.&lt;/p&gt;

&lt;p&gt;&lt;a class=&quot;image&quot; href=&quot;/images/Advanced-tab-of-System-Properties.png&quot; data-lightbox=&quot;image-2&quot; data-title=&quot;Advanced tab of System Properties&quot;&gt;
&lt;img src=&quot;/images/Advanced-tab-of-System-Properties.png&quot; style=&quot;width:200px;&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a class=&quot;image&quot; href=&quot;/images/Edit-System-Variables.png&quot; data-lightbox=&quot;image-2&quot; data-title=&quot;Edit System Variables&quot;&gt;
&lt;img src=&quot;/images/Edit-System-Variables.png&quot; style=&quot;width:200px;&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;h2 id=&quot;finally&quot;&gt;Finally…&lt;/h2&gt;

&lt;p&gt;If you try to register your DLL it should now work.&lt;/p&gt;

&lt;p&gt;&lt;a class=&quot;image&quot; href=&quot;/images/LoadLibrary-succeeded.png&quot; data-lightbox=&quot;image-2&quot; data-title=&quot;LoadLibrary succeeded&quot;&gt;
&lt;img src=&quot;/images/LoadLibrary-succeeded.png&quot; style=&quot;width:200px;&quot; /&gt;&lt;/a&gt;&lt;/p&gt;
</description>
        <pubDate>Wed, 17 Apr 2013 19:33:15 +0100</pubDate>
        <link>https://alistairmcmillan.github.io/windows/howto/2013/04/17/how-to-deal-with-the-specified-module-could-not-be-found-errors.html</link>
        <guid isPermaLink="true">https://alistairmcmillan.github.io/windows/howto/2013/04/17/how-to-deal-with-the-specified-module-could-not-be-found-errors.html</guid>
        
        
        <category>windows</category>
        
        <category>howto</category>
        
      </item>
    
      <item>
        <title>Unable to locate a Java Runtime to invoke</title>
        <description>&lt;p&gt;Tried to install the Android SDK today and OS X prompted me to install Java, which it did but then the Android SDK Manager failed with this error.&lt;/p&gt;

&lt;p&gt;“Unable to locate a Java Runtime to invoke.”&lt;/p&gt;

&lt;p&gt;Did a search on Google that turned up a bunch of results with a ton of really bad advice (including “Insert the system disk that came with your computer and start the installer from the desktop to re-install the system…”).&lt;/p&gt;

&lt;p&gt;Turns out to be a simple fix.&lt;/p&gt;

&lt;p&gt;Open Java Preferences from /Applications/Utilities and tick a box to tell the system which Java virtual machine you want to use.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/images/Java-Preferences.png&quot; alt=&quot;Java Preferences&quot; /&gt;&lt;/p&gt;
</description>
        <pubDate>Fri, 31 Aug 2012 15:46:00 +0100</pubDate>
        <link>https://alistairmcmillan.github.io/macosx/java/2012/08/31/unable-to-locate-a-java-runtime-to-invoke.html</link>
        <guid isPermaLink="true">https://alistairmcmillan.github.io/macosx/java/2012/08/31/unable-to-locate-a-java-runtime-to-invoke.html</guid>
        
        
        <category>macosx</category>
        
        <category>java</category>
        
      </item>
    
  </channel>
</rss>
